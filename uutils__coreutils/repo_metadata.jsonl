{"repo":"uutils/coreutils","pull_number":6268,"instance_id":"uutils__coreutils-6268","issue_numbers":[6261],"base_commit_sha":"7cee2c5a2b83499ef2227221ebc9122c1b77b380","patch":"diff --git a/src/uucore/src/lib/features/fsext.rs b/src/uucore/src/lib/features/fsext.rs\nindex 7f29a2dc6..99db194f8 100644\n--- a/src/uucore/src/lib/features/fsext.rs\n+++ b/src/uucore/src/lib/features/fsext.rs\n@@ -643,6 +643,7 @@ impl FsMeta for StatFs {\n             not(target_os = \"aix\"),\n             not(target_os = \"android\"),\n             not(target_os = \"freebsd\"),\n+            not(target_os = \"netbsd\"),\n             not(target_os = \"openbsd\"),\n             not(target_os = \"illumos\"),\n             not(target_os = \"solaris\"),\n@@ -654,6 +655,7 @@ impl FsMeta for StatFs {\n         #[cfg(all(\n             not(target_env = \"musl\"),\n             not(target_os = \"freebsd\"),\n+            not(target_os = \"netbsd\"),\n             not(target_os = \"redox\"),\n             any(\n                 target_arch = \"s390x\",\n@@ -668,6 +670,7 @@ impl FsMeta for StatFs {\n             target_env = \"musl\",\n             target_os = \"aix\",\n             target_os = \"freebsd\",\n+            target_os = \"netbsd\",\n             target_os = \"illumos\",\n             target_os = \"solaris\",\n             target_os = \"redox\",\n","test_patch":"","problem_statement":"Build for NetBSD failed\ncargo build for NetBSD is failing\r\n\r\n```\r\n   Compiling uucore v0.0.25 (/home/axbannaz/Projects/coreutils/src/uucore)\r\n   Compiling bigdecimal v0.4.0\r\nerror[E0308]: mismatched types\r\n   --> src/uucore/src/lib/features/fsext.rs:645:16\r\n    |\r\n632 |     fn block_size(&self) -> i64 {\r\n    |                             --- expected `i64` because of return type\r\n...\r\n645 |         return self.f_bsize;\r\n    |                ^^^^^^^^^^^^ expected `i64`, found `u64`\r\n    |\r\nhelp: you can convert a `u64` to an `i64` and panic if the converted value doesn't fit\r\n    |\r\n645 |         return self.f_bsize.try_into().unwrap();\r\n    |                            ++++++++++++++++++++\r\n\r\nFor more information about this error, try `rustc --explain E0308`.\r\nerror: could not compile `uucore` (lib) due to 1 previous error\r\nwarning: build failed, waiting for other jobs to finish...\r\n```\r\n\r\nI think `return self.f_bsize as i64` would fix it. tried it locally was successful.\r\n\r\n","pull_message":"Fixing the build issue on NetBSD\nThe NetBSD was missing from target-os checks on fsext.rs\r\n\r\nFixed #6261\r\n\r\ntested and works on NetBSD 10.0","hints":[],"created_at":"2024-04-24T15:27:46Z","cursor":"Y3Vyc29yOnYyOpK5MjAyNC0wNC0yNFQyMzoyNzo0NiswODowMM5tnirh","merge_commit_sha":"72b4a0888d06b513c92b2b7cc98e6129aa829dd8","test_files":[],"precommit_script":"","setup_command":"#!/usr/bin/env bash\nset -euo pipefail\n\n# Install Rust toolchain (if not installed) and cargo2junit for JUnit XML conversion\n# Do not use sudo. This script will attempt to install rustup if cargo is missing.\n\n# Ensure HOME is set\n: \"${HOME:=$HOME}\"\n\n# Add cargo to PATH if present\nexport PATH=\"$HOME/.cargo/bin:$PATH\"\n\nif ! command -v cargo >/dev/null 2>&1; then\n    echo \"cargo not found, installing rustup (stable toolchain)...\"\n    # Install rustup (non-interactive)\n    if command -v curl >/dev/null 2>&1; then\n        curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y\n    elif command -v wget >/dev/null 2>&1; then\n        wget -qO- https://sh.rustup.rs | sh -s -- -y\n    else\n        echo \"Error: neither curl nor wget is available to install rustup\" >&2\n        exit 1\n    fi\n    export PATH=\"$HOME/.cargo/bin:$PATH\"\nfi\n\n# Ensure cargo is now available\nif ! command -v cargo >/dev/null 2>&1; then\n    echo \"Error: cargo is not available after rustup installation\" >&2\n    exit 1\nfi\n\n# Install cargo2junit for converting cargo JSON output into JUnit XML\nif ! command -v cargo2junit >/dev/null 2>&1; then\n    echo \"Installing cargo2junit...\"\n    cargo install cargo2junit || {\n        echo \"cargo install cargo2junit failed, trying to install from crates.io may be unavailable\" >&2\n        exit 1\n    }\nfi\n\necho \"Setup complete.\"\ncargo fetch --locked\n","test_command":"","additions":3,"deletions":0,"file_changes":1,"image":"acvdpwu2p001dcr.azurecr.io/uutils__coreutils-6268:20251201"}
