{"repo":"jtroo/kanata","pull_number":454,"instance_id":"jtroo__kanata-454","issue_numbers":[449],"base_commit_sha":"98625e972e2ee18cbff73f5d2110fe68159927a3","patch":"diff --git a/src/trie.rs b/src/trie.rs\nindex 60a0d74..31f2696 100644\n--- a/src/trie.rs\n+++ b/src/trie.rs\n@@ -53,7 +53,9 @@ impl Trie {\n                         }\n                     }\n                     None => {\n-                        unreachable!(\"subtrie should have a key\")\n+                        // Note: None happens if there are multiple children. The sequence is still\n+                        // in the trie.\n+                        InTrie\n                     }\n                 }\n             }\n","test_patch":"","problem_statement":"Bug: kanata crashes randomly when typing a sequence in the latest build\n**Describe the bug**\r\nwhen i type a sequence, i get this error: \r\nthread '<unnamed>' panicked at 'internal error: entered unreachable code: subtrie should have a key', src\\trie.rs:56:25\r\nnote: run with `RUST_BACKTRACE=1` environment variable to display a backtrace\r\nerror: process didn't exit successfully: `target\\release\\kanata.exe --cfg c:/users/rizq/documents/doffed-kanata.kbd` (exit code: 0xc0000409, STATUS_STACK_BUFFER_OVERRUN)\r\n\r\n**Relevant kanata configs**\r\nhere's my config (though this bug should appear with any config that has sequences):\r\n```\r\n(defcfg\r\n  sequence-input-mode visible-backspaced\r\n  sequence-timeout 500\r\n  danger-enable-cmd yes\r\n  delegate-to-first-layer yes\r\n)\r\n\r\n(defsrc\r\n  esc   1     2     3     4     5     6     7     8     9     0     -     =     bspc\r\n  tab   q     w     e     r     t     y     u     i     o     p     [     ]     \\\r\n  caps  a     s     d     f     g     h     j     k     l     ;     '     ret\r\n  lsft  z     x     c     v     b     n     m     ,     .     /     rsft\r\n  lctl  lmet  lalt              spc               ralt  rmet\r\n)\r\n\r\n;; defines variables, t for tap-hold/tap-dance, d for one-shot\r\n(defvar t 150 d 500 max 65535 half 32769)\r\n\r\n;; main layer\r\n(deflayer maya\r\n  @grl  1     2     3     4     5     6     7     8     9     0     [     ]     @numnf\r\n  tab   b     l     d     g     q     j     f     o     u     @pcb  ;     =     \\\r\n  @bnav n     @chr  @cht  @chs  @chv  k     h     a     e     i     @oss  ret\r\n  @oss  @chx  @chm  @chc  @chw  z     p     y     '     /     @cms  @dsht\r\n  @mods lmet  @rsym             @sseq             ralt  rmet\r\n)\r\n\r\n(deflayer qwerty\r\n  @esl  1     2     3     4     5     6     7     8     9     0     -     =     bspc\r\n  tab   q     w     e     r     t     y     u     i     o     p     [     ]     \\\r\n  caps  a     s     d     f     g     h     j     k     l     ;     '     ret \r\n  lsft  z     x     c     v     b     n     m     ,     .     /     rsft\r\n  lctl  lmet  lalt              spc               ralt  rmet\r\n)\r\n\r\n(deflayer mouse\r\n  _      _     _     _     _     _     _     _     _     _     _     _     _     _\r\n  _      b     mrgt  d     mlft  q     mmid  mlft  @mwu  mrgt  _     _     _     _\r\n  C-bspc n     r     t     s     v     _     @mlft @mdn  @mup  @mrgt _     _\r\n  _      C-w   m     c     w     z     @my   mbtp  @mwd  mftp  _     _ \r\n  @grd   _     _                 @slw              _     _\r\n)\r\n\r\n(deflayer slow_mouse\r\n  _      _     _     _     _     _     _     _      _     _     _      _     _     _\r\n  _      _     _     _     _     _     mmid  mlft   @mwu  mrgt  _      _     _     _\r\n  C-bspc _     _     _     _     _     @mos  @smlf  @smdn @smup @smrg  _     _\r\n  _      _     _     _     _     _     @my   mbtp   @mwd  mftp  _      _ \r\n  _      _     _                 _                  _     _\r\n)\r\n\r\n(deflayer grid_mouse\r\n  _     _     _     _     _     _     _     _     _     _     _     _     _     _\r\n  _     _     _     _     _     _     _     @r1c1 @r1c2 @r1c3 @r1c4 _     _     _\r\n  _     _     _     _     _     _     @mos  @r2c1 @r2c2 @r2c3 @r2c4 _     _\r\n  _     _     _     _     _     _     @my   @r3c1 @r3c2 @r3c3 @r3c4 _ \r\n  _     _     _                 _                 _     _\r\n)\r\n\r\n;; sym layer, prob wiil add aliases for shifted keys\r\n(deflayer sym\r\n  _     _     _     _     _     _     _     _     _     _     _     _     _     _\r\n  _     4     2     3     1     5     6     0     8     9     7     S-,   _     _\r\n  `     S-4   +     S-9   S-0   S-`   \\     -     =     S--   S-8   S-.   _\r\n  S-\\   S-3   S-[   S-]   S-1   S-2   S-7   [     ]     S-5   S-6   _ \r\n  lmet  _     _                 _                 _     _\r\n)\r\n\r\n(deflayer nav\r\n  _     _     _     _     _     _     _     _     _     _     _     _     _     _\r\n  _     _     _     _     _     _     esc   ret   pgup  home  _     _     _     _\r\n  _     lmet  lalt  lsft  lctl  @dr   ins   lft   down  up    rght  _     _\r\n  _     _     _     tab   @dp   _     prnt  del   pgdn  end   _     _ \r\n  _     _     _                 _                 _     _\r\n)\r\n\r\n;; homerow mods\r\n(deflayer mods\r\n\r\n  _     _     _     _     _     _     _     _     _     _     _     _     _     _\r\n  _     _     _     _     _     _     _     _     _     _     _     _     _     _\r\n  _     @metn @altr @sftt @ctls _     _     @ctlh @sfta @alte @meti _     _\r\n  _     _     _     _     _     _     _     _     _     _     _     _ \r\n  _     _     _                 bspc              _     _\r\n)\r\n\r\n(deflayer cub1\r\n\r\n  _      _     _     _     _     _     _     _     _     _     _     _     _     _\r\n  _      @z'   @B    @L'   @l'   @x    @u    @r    @R    @B'   @z    _     _     _\r\n  C-bspc @y'   @D    @L    @U'   @F'   @F    @U    @R'   @D'   @y    _     _\r\n  @f'    @S'   @M'   @l    @my   @u'   @x'   @r'   @M    @S    @f    _ \r\n  _      _     _                 @cub2             _     _\r\n)\r\n\r\n(deflayer cub2\r\n\r\n  _     _     _     _     _     _     _     _     _     _     _     _     _     _\r\n  _     _     _     _     _     _     _     _     _     _     _     _     _     _\r\n  _     _     @d    _     _     _     _     _     _     @d'   _     _     _\r\n  _     _     _     _     _     _     _     _     _     _     _     _ \r\n  _     _     _                 _                 _     _\r\n)\r\n\r\n(defalias\r\n  ;; multi-function keys\r\n  grl (tap-hold $t $t grv (layer-toggle layouts))\r\n  esl (tap-hold $t $t esc (layer-toggle layouts))\r\n  rsym (tap-hold $t $t rpt (layer-toggle sym))\r\n  bnav (tap-hold $t $t C-bspc (layer-toggle nav))\r\n  mods (layer-toggle mods)\r\n  oss (one-shot $d lsft)\r\n  sseq (multi spc sldr) ;; used for emoji and cmini sequences\r\n  dsht (tap-dance $t (- (cmd powershell shutdown /s /t 0)))\r\n  numnf (tap-dance $t ((cmd-output-keys powershell.exe \"if ($([console]::NumberLock) -match 'True') { echo '()' } else { echo '(nlck)' }\") (cmd-output-keys powershell.exe \"if ($([console]::NumberLock) -match 'True') { echo '(nlck)' } else { echo '()' }\")))\r\n  cms (tap-dance $t (, (layer-switch mouse)))\r\n  mos (layer-switch mouse)\r\n  pcb (tap-dance $t (. (layer-switch cub1)))\r\n\r\n  ;; layouts\r\n  my (layer-switch maya)\r\n  tp (layer-switch l0)\r\n  qwr (layer-switch qwerty)\r\n\r\n  ;; consonant hand chord definitions\r\n  chr (chord cc r)\r\n  chs (chord cc s)\r\n  chc (chord cc c)\r\n  chw (chord cc w)\r\n  cht (chord cc t)\r\n  chv (chord cc v)\r\n  chm (chord cc m)\r\n  chx (chord cc x)\r\n\r\n  ;; dynamic macros\r\n  dr (dynamic-macro-record 0)\r\n  dp (dynamic-macro-play 0)\r\n\r\n  ;; taipo chords\r\n  ph (chord l0 ph)\r\n  rh (chord l0 rh)\r\n  mh (chord l0 mh)\r\n  ih (chord l0 ih)\r\n\r\n  pu (chord l0 pu)\r\n  ru (chord l0 ru)\r\n  mu (chord l0 mu)\r\n  iu (chord l0 iu)\r\n\r\n  ph1 (chord l1 ph1)\r\n  rh1 (chord l1 rh1)\r\n  mh1 (chord l1 mh1)\r\n  ih1 (chord l1 ih1)\r\n\r\n  pu1 (chord l1 pu1)\r\n  ru1 (chord l1 ru1)\r\n  mu1 (chord l1 mu1)\r\n  iu1 (chord l1 iu1)\r\n\r\n  ph2 (chord l2 ph2)\r\n  rh2 (chord l2 rh2)\r\n  mh2 (chord l2 mh2)\r\n  ih2 (chord l2 ih2)\r\n\r\n  pu2 (chord l2 pu2)\r\n  ru2 (chord l2 ru2)\r\n  mu2 (chord l2 mu2)\r\n  iu2 (chord l2 iu2)\r\n\r\n  ;; taipo layers\r\n  l0 (layer-toggle l0)\r\n  l1 (layer-toggle l1)\r\n  l2 (layer-toggle l2)\r\n\r\n  ;; homerow mods\r\n  metn (tap-hold $t $t n (one-shot $d lmet))\r\n  altr (tap-hold $t $t r (one-shot $d lalt))\r\n  sftt (tap-hold $t $t t (one-shot $d lsft))\r\n  ctls (tap-hold $t $t s (one-shot $d lctl))\r\n\r\n  ctlh (tap-hold $t $t h (one-shot $d rctl))\r\n  sfta (tap-hold $t $t a (one-shot $d rsft))\r\n  alte (tap-hold $t $t e (one-shot $d lalt))\r\n  meti (tap-hold $t $t i (one-shot $d lmet))\r\n\r\n  ;; mouse movement\r\n  mwu (mwheel-up 50 120)\r\n  mwd (mwheel-down 50 120)\r\n  mup (movemouse-accel-up 1 1000 1 5)\r\n  mlft (movemouse-accel-left 1 1000 1 5)\r\n  mdn (movemouse-accel-down 1 1000 1 5)\r\n  mrgt (movemouse-accel-right 1 1000 1 5)\r\n\r\n  smup (movemouse-up 3 1)\r\n  smlf (movemouse-left 3 1)\r\n  smdn (movemouse-down 3 1)\r\n  smrg (movemouse-right 3 1)\r\n\r\n  r1c1 (tap-dance $t ((setmouse 8192 10923) (setmouse 1 1)))\r\n  r1c2 (tap-dance $t ((setmouse 24576 10923) (setmouse 24576 1)))\r\n  r1c3 (tap-dance $t ((setmouse 40960 10923) (setmouse 40960 1)))\r\n  r1c4 (tap-dance $t ((setmouse 57344 10923) (setmouse $max 1)))\r\n  r2c1 (setmouse 8192 $half)\r\n  r2c2 (tap-dance $t ((setmouse 24576 $half) (setmouse $half $half)))\r\n  r2c3 (setmouse 40960 $half)\r\n  r2c4 (setmouse 57344 $half)\r\n  r3c1 (tap-dance $t ((setmouse 8192 54615) (setmouse 1 $max)))\r\n  r3c2 (tap-dance $t ((setmouse 24576 54615) (setmouse 24576 $max)))\r\n  r3c3 (tap-dance $t ((setmouse 40960 54615) (setmouse 40960 $max)))\r\n  r3c4 (tap-dance $t ((setmouse 57344 54615) (setmouse $max $max)))\r\n\r\n  ;; mouse layers\r\n  slw (layer-toggle slow_mouse)\r\n  grd (layer-toggle grid_mouse)\r\n\r\n  ;; taipo fn for typing f keys\r\n  fn (macro sldr 10 f24)\r\n\r\n  ;; cubing moves\r\n  R (tap-dance $t ((macro S-r spc) (macro S-r kp2 spc)))\r\n  R' (tap-dance $t ((macro S-r ' spc) (macro S-r kp2 ' spc)))\r\n  U (tap-dance $t ((macro S-u spc) (macro S-u kp2 spc)))\r\n  U' (tap-dance $t ((macro S-u ' spc) (macro S-u kp2 ' spc)))\r\n  F (tap-dance $t ((macro S-f spc) (macro S-f kp2 spc)))\r\n  F' (tap-dance $t ((macro S-f ' spc) (macro S-f kp2 ' spc)))\r\n  L (tap-dance $t ((macro S-l spc) (macro S-l kp2 spc)))\r\n  L' (tap-dance $t ((macro S-l ' spc) (macro S-l kp2 ' spc)))\r\n  D (tap-dance $t ((macro S-d spc) (macro S-d kp2 spc)))\r\n  D' (tap-dance $t ((macro S-d ' spc) (macro S-d kp2 ' spc)))\r\n  B (tap-dance $t ((macro S-b spc) (macro S-b kp2 spc)))\r\n  B' (tap-dance $t ((macro S-b ' spc) (macro S-b kp2 ' spc)))\r\n\r\n  r (tap-dance $t ((macro r spc) (macro r kp2 spc)))\r\n  r' (tap-dance $t ((macro r ' spc) (macro r kp2 ' spc)))\r\n  u (tap-dance $t ((macro u spc) (macro u kp2 spc)))\r\n  u' (tap-dance $t ((macro u ' spc) (macro u kp2 ' spc)))\r\n  l (tap-dance $t ((macro l spc) (macro l kp2 spc)))\r\n  l' (tap-dance $t ((macro l ' spc) (macro l kp2 ' spc)))\r\n  f (tap-dance $t ((macro f spc) (macro f kp2 spc)))\r\n  f' (tap-dance $t ((macro f ' spc) (macro f kp2 ' spc)))\r\n  d (tap-dance $t ((macro d spc) (macro d kp2 spc)))\r\n  d' (tap-dance $t ((macro d ' spc) (macro d kp2 ' spc)))\r\n\r\n  M (tap-dance $t ((macro S-m spc) (macro S-m kp2 spc)))\r\n  M' (tap-dance $t ((macro S-m ' spc) (macro S-m kp2 ' spc)))\r\n  S (tap-dance $t ((macro S-s spc) (macro S-s kp2 spc)))\r\n  S' (tap-dance $t ((macro S-s ' spc) (macro S-s kp2 ' spc)))\r\n\r\n  y (tap-dance $t ((macro y spc) (macro y kp2 spc)))\r\n  y' (tap-dance $t ((macro y ' spc) (macro y kp2 spc)))\r\n  x (tap-dance $t ((macro x spc) (macro x kp2 spc)))\r\n  x' (tap-dance $t ((macro x ' spc) (macro x kp2 spc)))\r\n  z (tap-dance $t ((macro z spc) (macro z kp2 spc)))\r\n  z' (tap-dance $t ((macro z ' spc) (macro z kp2 spc)))\r\n\r\n  cub2 (layer-toggle cub2)\r\n)\r\n\r\n;; consonant hand chords\r\n(defchords cc 30\r\n  (r              ) r\r\n  (  s            ) s\r\n  (    c          ) c\r\n  (      w        ) w\r\n  (        t      ) t\r\n  (          v    ) v\r\n  (            m  ) m\r\n  (              x) x\r\n  (r s            ) (macro r l)\r\n  (r     w        ) (macro s c)\r\n  (r     w t      ) (macro s c r)\r\n  (r s     t      ) (macro r l d)\r\n  (    c   t      ) (multi (one-shot 50 lctl) c)\r\n  (        t v    ) (multi (one-shot 50 lctl) v)\r\n  (    c       m  ) (macro m b)\r\n  (            m x) (macro b l)\r\n  (    c w     m  ) (macro s i d)\r\n)\r\n\r\n;; used for sequences\r\n(deffakekeys\r\n  ;; taipo f key sequences\r\n  f1 f1\r\n  f2 f2\r\n  f3 f3\r\n  f4 f4\r\n  f5 f5\r\n  f6 f6\r\n  f7 f7\r\n  f8 f8\r\n  f9 f9\r\n  f10 f10\r\n  f11 f11\r\n  f12 f12\r\n\r\n  ;; emoji sequences\r\n  dbl (macro S-; d o f b l u s h S-; spc)\r\n  dnn (macro S-; d o f n i n i S-; spc)\r\n  dtv (macro S-; d o f t e c t i v e S-; spc)\r\n  dsm (macro S-; d o f s m i e S-; spc)\r\n  dbn (macro S-; d o f b l a n k e e S-; spc)\r\n  dxy (macro S-; o x e y S-; spc)\r\n  dcb (macro S-; d o f c u b e S-; spc)\r\n  dwi (macro S-; d o f w i t h i t S-; spc)\r\n  dgn (macro S-; d o f g u n S-; spc)\r\n  ddg (macro S-; d o f d g e S-; spc)\r\n  dwn (macro S-; d o f S-w S-; spc)\r\n  dqn (macro S-; d o f q u e e n S-; spc)\r\n  dsi (macro S-; d o f i s s u e S-; spc)\r\n  dkl (macro S-; d o f a k l S-; spc)\r\n  dtr (macro S-; d o f t l d r S-; spc)\r\n  djl (macro S-; d o f j a i l S-; spc)\r\n  smd (macro S-; s m i e d o f S-; spc)\r\n  dcn (macro S-; b u s h d o f S-; spc)\r\n  dns (macro S-; d o f n i n i s S-; spc)\r\n  dbr (macro S-; d o f b r i a n S-; spc)\r\n  sbc (macro S-; S-s o b S-c a t S-; spc)\r\n  ymc (macro S-; S-y u m S-c a t S-; spc)\r\n  wgc (macro S-; S-w o a g S-c a t S-; spc)\r\n  wrc (macro S-; S-w o r r i e d S-c a t S-; spc)\r\n  mnc (macro S-; S-m e n a c e S-c a t S-; spc)\r\n  hec (macro S-; h e a r t S-- e y e s S-- c a t S-; spc)\r\n  blc (macro S-; S-f l u s h e d S-c a t S-; spc)\r\n  htc (macro S-; S-h o t S-c a t S-; spc)\r\n  cdc (macro S-; S-c o l d S-c a t S-; spc)\r\n  pnc (macro S-; S-p e n s i v e S-c a t S-; spc)\r\n  ywc (macro S-; S-y a w n i n g S-c a t S-; spc)\r\n  csp (macro S-; c a t s p a i r S-; spc)\r\n  pbg (macro S-; b u g S-; spc)\r\n  rbg (macro S-; r a r e b u g S-; spc)\r\n  bbg (macro S-; b u g g i g n S-; spc)\r\n  wpy (macro S-; w o o p e r S-;)\r\n  wpn (macro S-; w o o p e r n o S-;)\r\n  dpt (macro S-; d o f p e t S-;)\r\n  flc (macro S-; S-f l u s h e d S-c a t S-;)\r\n  nsc (macro S-; S-n a u s e o u s S-c a t S-;)\r\n  pld (macro S-; p l e a d i n g S-(r e a l) S-;)\r\n  cbk (macro S-; c a t b o n k S-;)\r\n  dbd (macro S-; d o f b l u s h t e c t i v e S-;)\r\n  bls (macro S-; b l u s h d o f S-;)\r\n  ;; cmini sequences\r\n  add (macro S-1 c m i n i spc a d d spc S-ret grv grv grv S-ret grv grv grv C-lft C-lft C-lft C-lft)\r\n  corpus (macro S-1 c m i n i spc c o r p u s spc)\r\n  swap! (macro S-1 c m i n i spc s w a p S-1 spc)\r\n  swap (macro S-1 c m i n i spc s w a p spc)\r\n  examples (macro S-1 c m i n i spc e x a m p l e s spc)\r\n  homerow (macro S-1 c m i n i spc h o m e r o w spc)\r\n  like (macro S-1 c m i n i spc l i k e spc)\r\n  likes (macro S-1 c m i n i spc l i k e s spc)\r\n  list (macro S-1 c m i n i spc l i s t spc)\r\n  remove (macro S-1 c m i n i spc r e m o v e spc)\r\n  rename (macro S-1 c m i n i spc r e n a m e spc)\r\n  search (macro S-1 c m i n i spc s e a r c h spc)\r\n  sfbs (macro S-1 c m i n i spc s f b s spc)\r\n  sfss (macro S-1 c m i n i spc s f s spc)\r\n  stats (macro S-1 c m i n i spc s t a t s spc)\r\n  unlike (macro S-1 c m i n i spc u n l i k e spc)\r\n  view (macro S-1 c m i n i spc v i e w spc)\r\n  names (macro S-1 c m i n i spc n a m e s S-ret grv grv grv S-ret grv grv grv)\r\n  dofball (macro S-1 c m i n i spc d o f b a l l spc) \r\n  catball (macro S-1 c m i n i spc c a t b a l l spc)\r\n  wooperball (macro S-1 c m i n i spc w o o p e r b a l l spc)\r\n  8ball (macro S-1 c m i n i spc 8 b a l l spc)\r\n  suggest (macro S-1 c m i n i spc s u g g e s t spc)\r\n  pairings (macro S-1 c m i n i spc p a i r i n g s spc)\r\n  freq (macro S-1 c m i n i spc f r e q spc)\r\n  cmini (macro S-1 c m i n i spc)\r\n\r\n  tnl (cmd powershell start-process wt.exe)\r\n  lvt (macro c d spc l e v e l t y p e / c m d ret 100 g o spc r u n spc m a i n . g o ret)\r\n  lyz (macro c d spc o x e y l y z e r ret 100 c a r g o spc r u n spc - - r e l e a s e ret)\r\n)\r\n\r\n;; where sequences are defined\r\n(defseq\r\n  f1 (f24 1)\r\n  f2 (f24 2)\r\n  f3 (f24 3)\r\n  f4 (f24 4)\r\n  f5 (f24 5)\r\n  f6 (f24 6)\r\n  f7 (f24 7)\r\n  f8 (f24 8)\r\n  f9 (f24 9)\r\n  f10 (f24 0)\r\n  f11 (f24 o 1)\r\n  f12 (f24 o 2)\r\n\r\n  dbl (d b l spc)\r\n  dnn (d n n spc)\r\n  dtv (d t v spc)\r\n  dsm (d s m spc)\r\n  dbn (d b n spc)\r\n  dxy (d x y spc)\r\n  dcb (d c b spc)\r\n  dwi (d w i spc)\r\n  dgn (d g n spc)\r\n  ddg (d d g spc)\r\n  dwn (d w n spc)\r\n  dqn (d q n spc)\r\n  dsi (d s i spc)\r\n  dkl (d k l spc)\r\n  dtr (d t r spc)\r\n  djl (d j l spc)\r\n  smd (s m d spc)\r\n  dcn (d c n spc)\r\n  dns (d n s spc)\r\n  dbr (d b r spc)\r\n  sbc (s b c spc)\r\n  ymc (y m c spc)\r\n  wgc (w g c spc)\r\n  wrc (w r c spc)\r\n  mnc (m n c spc)\r\n  hec (h e c spc)\r\n  blc (b l c spc)\r\n  htc (h t c spc)\r\n  cdc (c d c spc)\r\n  pnc (p n c spc)\r\n  ywc (y w c spc)\r\n  csp (c s p spc)\r\n  pbg (p b g spc)\r\n  rbg (r b g spc)\r\n  bbg (b b g spc)\r\n  wpy (w p y spc)\r\n  wpn (w p n spc)\r\n  dpt (d p t spc)\r\n  flc (f l c spc)\r\n  nsc (n s c spc)\r\n  pld (p l d spc)\r\n  cbk (c b k spc)\r\n  dbd (d b d spc)\r\n  bls (b l s spc)\r\n\r\n  add (, a spc)\r\n  corpus (, c p spc)\r\n  swap! (, s p spc)\r\n  swap (, s spc)\r\n  examples (, e spc)\r\n  homerow (, h spc)\r\n  like (, t spc)\r\n  likes (, t s spc)\r\n  list (, l spc)\r\n  remove (, r spc)\r\n  rename (, n spc)\r\n  search (, f spc)\r\n  sfbs (, f b spc)\r\n  sfss (, f s spc)\r\n  stats (, s t spc)\r\n  unlike (, u t spc)\r\n  view (, v spc)\r\n  names (, n s spc)\r\n  dofball (, d b spc)\r\n  catball (, c b spc)\r\n  wooperball (, w b spc)\r\n  8ball (, e b spc)\r\n  suggest (, g spc)\r\n  pairings (, p spc)\r\n  freq (, q spc)\r\n  cmini (, c spc)\r\n\r\n  tnl (t n l spc)\r\n  lvt (l v t spc)\r\n  lyz (l y z spc)\r\n)\r\n\r\n;; taipo chords\r\n(defchords l0 30\r\n  (ih                     ) e\r\n  (   mh                  ) t\r\n  (      rh               ) o\r\n  (         ph            ) a\r\n  (            iu         ) i\r\n  (               mu      ) n\r\n  (                  ru   ) s\r\n  (                     pu) r\r\n  (ih mh                  ) h\r\n  (      rh ph            ) l\r\n  (            iu mu      ) y\r\n  (                  ru pu) b\r\n  (            iu       pu) g\r\n  (   mh rh               ) u\r\n  (ih       ph            ) d\r\n  (               mu ru   ) p\r\n  (ih    rh               ) c\r\n  (   mh    ph            ) q\r\n  (            iu    ru   ) f\r\n  (               mu    pu) z\r\n  (ih                ru   ) v\r\n  (   mh                pu) x\r\n  (      rh    iu         ) k\r\n  (         ph    mu      ) j\r\n  (      rh       mu      ) -\r\n  (         ph iu         ) w\r\n  (ih                   pu) m\r\n  (   mh             ru   ) /\r\n  (         ph       ru   ) '\r\n  (      rh             pu) ;\r\n  (   mh       iu         ) S-/\r\n  (ih             mu      ) ,\r\n  (ih          iu         ) (one-shot $t lsft)\r\n  (   mh          mu      ) (one-shot $t lctl)\r\n  (      rh          ru   ) (one-shot $t lalt)\r\n  (         ph          pu) (one-shot $t lmet)\r\n  (ih mh rh               ) (one-shot $t ret)\r\n  (            iu mu ru   ) (one-shot $t tab)\r\n)\r\n\r\n(defchords l1 30\r\n  (ih1                            ) S-e\r\n  (    mh1                        ) S-t\r\n  (        rh1                    ) S-o\r\n  (            ph1                ) S-a\r\n  (                iu1            ) S-i\r\n  (                    mu1        ) S-n\r\n  (                        ru1    ) S-s\r\n  (                            pu1) S-r\r\n  (ih1 mh1                        ) S-h\r\n  (        rh1 ph1                ) S-l\r\n  (                iu1 mu1        ) S-y\r\n  (                        ru1 pu1) S-b\r\n  (                iu1         pu1) S-g\r\n  (    mh1 rh1                    ) S-u\r\n  (ih1         ph1                ) S-d\r\n  (                    mu1 ru1    ) S-p\r\n  (ih1     rh1                    ) S-c\r\n  (    mh1     ph1                ) S-q\r\n  (                iu1     ru1    ) S-f\r\n  (                    mu1     pu1) S-z\r\n  (ih1                     ru1    ) S-v\r\n  (    mh1                     pu1) S-x\r\n  (        rh1     iu1            ) S-k\r\n  (            ph1     mu1        ) S-j\r\n  (        rh1         mu1        ) S--\r\n  (            ph1 iu1            ) S-w\r\n  (ih1                         pu1) S-m\r\n  (    mh1                 ru1    ) \\\r\n  (            ph1         ru1    ) S-'\r\n  (        rh1                 pu1) S-;\r\n  (    mh1         iu1            ) S-1\r\n  (ih1                 mu1        ) .\r\n  (ih1             iu1            ) (one-shot $t lft)\r\n  (    mh1             mu1        ) (one-shot $t down)\r\n  (        rh1             ru1    ) (one-shot $t up)\r\n  (            ph1             pu1) (one-shot $t rght)\r\n  (ih1 mh1 rh1                    ) (one-shot $t esc)\r\n  (                iu1 mu1 ru1    ) (one-shot $t del)\r\n)\r\n\r\n(defchords l2 30\r\n  (ih2                            ) S-9\r\n  (    mh2                        ) [\r\n  (        rh2                    ) S-[\r\n  (            ph2                ) S-,\r\n  (                iu2            ) S-0\r\n  (                    mu2        ) ]\r\n  (                        ru2    ) S-]\r\n  (                            pu2) S-.\r\n  (ih2 mh2                        ) 0\r\n  (        rh2 ph2                ) 4\r\n  (                iu2 mu2        ) 5\r\n  (                        ru2 pu2) 9\r\n  (                iu2         pu2) S-3\r\n  (    mh2 rh2                    ) 2\r\n  (ih2         ph2                ) S-2\r\n  (                    mu2 ru2    ) 7\r\n  (ih2     rh2                    ) 1\r\n  (    mh2     ph2                ) 3\r\n  (                iu2     ru2    ) 6\r\n  (                    mu2     pu2) 8\r\n  (ih2                     ru2    ) S-8\r\n  (    mh2                     pu2) S-6\r\n  (        rh2     iu2            ) +\r\n  (            ph2     mu2        ) =\r\n  (        rh2         mu2        ) S-5\r\n  (            ph2 iu2            ) S-7\r\n  (ih2                         pu2) S-4\r\n  (    mh2                 ru2    ) S-\\\r\n  (            ph2         ru2    ) `\r\n  (ih2                 mu2        ) S-`\r\n  (ih2             iu2            ) (one-shot $t pgdn)\r\n  (    mh2             mu2        ) (one-shot $t end)\r\n  (        rh2             ru2    ) (one-shot $t home)\r\n  (            ph2             pu2) (one-shot $t pgup)\r\n  (ih2 mh2 rh2                    ) (one-shot $t ralt)\r\n  (                iu2 mu2 ru2    ) @fn\r\n)\r\n\r\n;; layouts layer\r\n(deflayer layouts\r\n  _     @qwr  @my   lrld  _     _     _     _     _     _     _     _     _     _\r\n  _     @tp   _     _     _     _     _     _     _     _     _     _     _     _\r\n  _     _     _     _     _     _     _     _     _     _     _     _     _\r\n  _     _     _     _     _     _     _     _     _     _     _     _ \r\n  _     _     _                 _                 _     _\r\n)\r\n\r\n;; taipo layers, hidden at the bottom because they look ugly\r\n(deflayer l0\r\n  @grl  _     _     _     _     _     _     _     _     _     _     _     _     _\r\n  _     @pu   @ru   @mu   @iu   _     _     _     _     @iu   @mu   @ru   @pu   @pu\r\n  _     @ph   @rh   @mh   @ih   _     _     _     _     @ih   @mh   @rh   @ph\r\n  _     _     _     _     _     _     _     _     _     _     _     _ \r\n  @l2   _     @l1               _                 _     _\r\n)\r\n\r\n(deflayer l1\r\n  @grl  _     _     _     _     _     _     _     _     _     _     _     _     _\r\n  _     @pu1  @ru1  @mu1  @iu1  _     _     _     _     @iu1  @mu1  @ru1  @pu1  @pu1\r\n  _     @ph1  @rh1  @mh1  @ih1  _     _     _     _     @ih1  @mh1  @rh1  @ph1\r\n  _     _     _     _     _     _     _     _     _     _     _     _ \r\n  @l2   _     _                 _                 _     _\r\n)\r\n\r\n(deflayer l2\r\n  @grl  _     _     _     _     _     _     _     _     _     _     _     _     _\r\n  _     @pu2  @ru2  @mu2  @iu2  _     _     _     _     @iu2  @mu2  @ru2  @pu2  @pu2\r\n  _     @ph2  @rh2  @mh2  @ih2  _     _     _     _     @ih2  @mh2  @rh2  @ph2\r\n  _     _     _     _     _     _     _     _     _     _     _     _ \r\n  _     _     @l1               _                 _     _\r\n)\r\n```\r\n\r\n**To reproduce**\r\nuse the config above, press space (starts sequence leader) then type `,q`.\r\n\r\n**Expected behavior**\r\n`!cmini freq ` to be outputted.\r\n\r\n**Operating system**\r\nWindows 11\r\n\r\n**Additional context**\r\nkanata sometimes crashes randomly without typing a sequence but I can't find a way to replicate it.","pull_message":"fix: sequence mode crashing\n","hints":[],"created_at":"2023-06-19T03:32:06Z","cursor":"Y3Vyc29yOnYyOpK5MjAyMy0wNi0xOVQxMTozMjowNiswODowMM5TS3AA","merge_commit_sha":"f98cbf80b8fdf4589f90a404015c32bbd51b5452","test_files":[],"precommit_script":"","setup_command":"#!/usr/bin/env bash\nset -euo pipefail\n\n# Minimal environment setup for running tests in this Rust workspace.\n# This script avoids using sudo and installs rustup (and the Rust toolchain) if\n# cargo is not already present.\n\nif ! command -v cargo >/dev/null 2>&1; then\n  echo \"cargo not found, installing rustup and Rust toolchain...\"\n  # Install rustup (non-interactive)\n  curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y\n  # Add cargo to PATH for the current session\n  export PATH=\"$HOME/.cargo/bin:$PATH\"\nelse\n  echo \"cargo found: $(cargo --version)\"\nfi\n\n# Ensure Python is available\nif ! command -v python3 >/dev/null 2>&1; then\n  echo \"python3 is required but not found. Please install Python3.\"\n  exit 1\nfi\n\n# No additional Python packages are required because test output is converted\n# to JUnit XML using the standard library.\n\necho \"setup complete\"\n\ncargo fetch --locked\n","test_command":"","additions":3,"deletions":1,"file_changes":1,"image":"acvdpwu2p001dcr.azurecr.io/jtroo__kanata-454:20251201"}
{"repo":"astral-sh/uv","pull_number":15377,"instance_id":"astral-sh__uv-15377","issue_numbers":[15372],"base_commit_sha":"075291f23e88fa37f0aa2248c8864e4578814035","patch":"diff --git a/crates/uv/src/commands/project/init.rs b/crates/uv/src/commands/project/init.rs\nindex 98845d1f4..ccf5d9118 100644\n--- a/crates/uv/src/commands/project/init.rs\n+++ b/crates/uv/src/commands/project/init.rs\n@@ -769,6 +769,10 @@ impl InitProjectKind {\n     ) -> Result<()> {\n         fs_err::create_dir_all(path)?;\n \n+        // Initialize the version control system first so that Git configuration can properly\n+        // read conditional includes that depend on the repository path.\n+        init_vcs(path, vcs)?;\n+\n         // Do no fill in `authors` for non-packaged applications unless explicitly requested.\n         let author_from = author_from.unwrap_or_else(|| {\n             if package {\n@@ -828,9 +832,6 @@ impl InitProjectKind {\n         }\n         fs_err::write(path.join(\"pyproject.toml\"), pyproject)?;\n \n-        // Initialize the version control system.\n-        init_vcs(path, vcs)?;\n-\n         Ok(())\n     }\n \n@@ -855,6 +856,10 @@ impl InitProjectKind {\n \n         fs_err::create_dir_all(path)?;\n \n+        // Initialize the version control system first so that Git configuration can properly\n+        // read conditional includes that depend on the repository path.\n+        init_vcs(path, vcs)?;\n+\n         let author = get_author_info(path, author_from.unwrap_or_default());\n \n         // Create the `pyproject.toml`\n@@ -880,9 +885,6 @@ impl InitProjectKind {\n             generate_package_scripts(name, path, build_backend, true)?;\n         }\n \n-        // Initialize the version control system.\n-        init_vcs(path, vcs)?;\n-\n         Ok(())\n     }\n }\n","test_patch":"","problem_statement":"uv init should do git init before getting author information from git\n### Summary\n\nWhen using git to get the author information for `pyproject.toml`, I wondered why it was only getting my name but not my email address.\n\nI use `includeIf` in `.gitconfig` to set email address depending on folder (work/private):\n\n```gitconfig\n\n[user]\nname = My Name\n\n[includeIf \"gitdir:~/repositories/work/\"]\n  path = ./.gitconfig.work\n[includeIf \"gitdir:~/repositories/privat/\"]\n  path = ./.gitconfig.privat\n```\n\ngit will only include these files when called in a directory with a `.git` subdirectory, as the config states:\n\n\n> The data that follows the keyword gitdir: is used as a glob pattern. If the location of the .git directory matches the pattern, the include condition is met.\n> \n> The .git location may be auto-discovered, or come from $GIT_DIR environment variable. If the repository is auto-discovered via a .git file (e.g. from submodules, or a linked worktree), the .git location would be the final location where the .git directory is, not where the .git file is.\n> \n> \n\nWhen doing `uv init` it seems that the author information is collected from git before the git repository gets initialized which means it can't get the email information.\n\nIf possible it would be nice if uv could init git before collecting the author information from it so that the email address is included in `pyproject.toml`.\n\n### Example\n\n_No response_","pull_message":"Initialize Git prior to reading author\n## Summary\r\n\r\nCloses https://github.com/astral-sh/uv/issues/15372.\r\n","hints":[],"created_at":"2025-08-19T10:29:53Z","cursor":"Y3Vyc29yOnYyOpK5MjAyNS0wOC0xOVQxODoyOTo1MyswODowMM6kRPKi","merge_commit_sha":"c58192eebe45dabb0db15f4903aae611745e0019","test_files":[],"precommit_script":"","setup_command":"#!/usr/bin/env bash\nset -euo pipefail\n\n# Install pytest for running tests and generating JUnit XML report\npython -m pip install --upgrade pip\npython -m pip install -q pytest\n\n# Install packages that are used by tests across the repository\npython -m pip install -q keyring httpx\n\n# Ensure we have any additional common testing dependencies that may be needed by tests in this repo\n# (add more as discovered)\n\ncargo fetch --locked\n","test_command":"","additions":8,"deletions":6,"file_changes":1,"image":"acvdpwu2p001dcr.azurecr.io/astral-sh__uv-15377:20251201"}
{"repo":"reacherhq/check-if-email-exists","pull_number":714,"instance_id":"reacherhq__check-if-email-exists-714","issue_numbers":[569],"base_commit_sha":"18a97afa08c32ca72fa9ac6476bbc93618558b5e","patch":"diff --git a/core/src/smtp/mod.rs b/core/src/smtp/mod.rs\nindex b380260..da5d281 100644\n--- a/core/src/smtp/mod.rs\n+++ b/core/src/smtp/mod.rs\n@@ -203,7 +203,8 @@ async fn email_deliverable(\n \t\t\t\tlet message = message.to_lowercase();\n \t\t\t\tlet is_deliverable = message.contains(\"2.1.5\") || \n \t\t\t\t\t// 250 Recipient address accepted\n-\t\t\t\t\tmessage.contains(\"recipient address accepted\");\n+\t\t\t\t\t// 250 Accepted\n+\t\t\t\t\tmessage.contains(\"accepted\");\n \t\t\t\tOk(Deliverability {\n \t\t\t\t\thas_full_inbox: false,\n \t\t\t\t\tis_deliverable,\n@@ -357,7 +358,15 @@ async fn create_smtp_future(\n \tlet is_catch_all = smtp_is_catch_all(&mut smtp_client, domain)\n \t\t.await\n \t\t.unwrap_or(false);\n-\tlet deliverability = email_deliverable(&mut smtp_client, to_email).await?;\n+\tlet deliverability = if is_catch_all {\n+\t\tDeliverability {\n+\t\t\thas_full_inbox: false,\n+\t\t\tis_deliverable: true,\n+\t\t\tis_disabled: false,\n+\t\t}\n+\t} else {\n+\t\temail_deliverable(&mut smtp_client, to_email).await?\n+\t};\n \n \tsmtp_client.close().await?;\n \n","test_patch":"","problem_statement":"Catch All parse failed\nHey, I'm getting an error that I think could be avoided.\r\n\r\nFor outlook server sometimes I get this return:\r\n![image](https://user-images.githubusercontent.com/232648/91592821-81e49080-e935-11ea-93c5-7e80402c8cab.png)\r\n\r\nIf I'm not wrong, this is a catch all return, am I right?\r\n\r\nThanks.","pull_message":"fix: Don't check inputted email if catch-all\nfixes #569 ","hints":[],"created_at":"2020-11-11T16:54:50Z","cursor":"Y3Vyc29yOnYyOpK5MjAyMC0xMS0xMlQwMDo1NDo1MCswODowMM4e9Ebp","merge_commit_sha":"5129dd1374d3ef93db632f6d7e140e3ce69369b2","test_files":[],"precommit_script":"","setup_command":"#!/usr/bin/env bash\nset -euo pipefail\n\n# Setup script for running tests in this repository.\n# Installs any required tools locally (no sudo) so tests can run and generate JUnit XML.\n\n# Ensure python3 is available\nif ! command -v python3 >/dev/null 2>&1; then\n    echo \"python3 is required but not found. Please install python3.\"\n    exit 1\nfi\n\n# Ensure cargo (Rust) is available; if not, try to install rustup (non-interactive)\nif ! command -v cargo >/dev/null 2>&1; then\n    echo \"cargo not found. Installing rustup...\"\n    # Install rustup (no sudo)\n    if command -v curl >/dev/null 2>&1; then\n        curl https://sh.rustup.rs -sSf | sh -s -- -y\n        # shellcheck disable=SC1090\n        source \"$HOME/.cargo/env\"\n    elif command -v wget >/dev/null 2>&1; then\n        wget -qO- https://sh.rustup.rs | sh -s -- -y\n        # shellcheck disable=SC1090\n        source \"$HOME/.cargo/env\"\n    else\n        echo \"Neither curl nor wget available to install rustup. Exiting.\"\n        exit 1\n    fi\nfi\n\n# Install python helper for junit xml if available (non-fatal)\n# The run_tests.sh script includes a lightweight Python parser and does not strictly\n# require extra packages, but install junit-xml for interoperability.\nif command -v pip3 >/dev/null 2>&1; then\n    pip3 install --user junit-xml || true\nfi\n\n# Done\necho \"Setup complete.\"\n\ncargo fetch --locked\n","test_command":"","additions":11,"deletions":2,"file_changes":1,"image":"acvdpwu2p001dcr.azurecr.io/reacherhq__check-if-email-exists-714:20251201"}
{"repo":"uutils/coreutils","pull_number":6268,"instance_id":"uutils__coreutils-6268","issue_numbers":[6261],"base_commit_sha":"7cee2c5a2b83499ef2227221ebc9122c1b77b380","patch":"diff --git a/src/uucore/src/lib/features/fsext.rs b/src/uucore/src/lib/features/fsext.rs\nindex 7f29a2dc6..99db194f8 100644\n--- a/src/uucore/src/lib/features/fsext.rs\n+++ b/src/uucore/src/lib/features/fsext.rs\n@@ -643,6 +643,7 @@ impl FsMeta for StatFs {\n             not(target_os = \"aix\"),\n             not(target_os = \"android\"),\n             not(target_os = \"freebsd\"),\n+            not(target_os = \"netbsd\"),\n             not(target_os = \"openbsd\"),\n             not(target_os = \"illumos\"),\n             not(target_os = \"solaris\"),\n@@ -654,6 +655,7 @@ impl FsMeta for StatFs {\n         #[cfg(all(\n             not(target_env = \"musl\"),\n             not(target_os = \"freebsd\"),\n+            not(target_os = \"netbsd\"),\n             not(target_os = \"redox\"),\n             any(\n                 target_arch = \"s390x\",\n@@ -668,6 +670,7 @@ impl FsMeta for StatFs {\n             target_env = \"musl\",\n             target_os = \"aix\",\n             target_os = \"freebsd\",\n+            target_os = \"netbsd\",\n             target_os = \"illumos\",\n             target_os = \"solaris\",\n             target_os = \"redox\",\n","test_patch":"","problem_statement":"Build for NetBSD failed\ncargo build for NetBSD is failing\r\n\r\n```\r\n   Compiling uucore v0.0.25 (/home/axbannaz/Projects/coreutils/src/uucore)\r\n   Compiling bigdecimal v0.4.0\r\nerror[E0308]: mismatched types\r\n   --> src/uucore/src/lib/features/fsext.rs:645:16\r\n    |\r\n632 |     fn block_size(&self) -> i64 {\r\n    |                             --- expected `i64` because of return type\r\n...\r\n645 |         return self.f_bsize;\r\n    |                ^^^^^^^^^^^^ expected `i64`, found `u64`\r\n    |\r\nhelp: you can convert a `u64` to an `i64` and panic if the converted value doesn't fit\r\n    |\r\n645 |         return self.f_bsize.try_into().unwrap();\r\n    |                            ++++++++++++++++++++\r\n\r\nFor more information about this error, try `rustc --explain E0308`.\r\nerror: could not compile `uucore` (lib) due to 1 previous error\r\nwarning: build failed, waiting for other jobs to finish...\r\n```\r\n\r\nI think `return self.f_bsize as i64` would fix it. tried it locally was successful.\r\n\r\n","pull_message":"Fixing the build issue on NetBSD\nThe NetBSD was missing from target-os checks on fsext.rs\r\n\r\nFixed #6261\r\n\r\ntested and works on NetBSD 10.0","hints":[],"created_at":"2024-04-24T15:27:46Z","cursor":"Y3Vyc29yOnYyOpK5MjAyNC0wNC0yNFQyMzoyNzo0NiswODowMM5tnirh","merge_commit_sha":"72b4a0888d06b513c92b2b7cc98e6129aa829dd8","test_files":[],"precommit_script":"","setup_command":"#!/usr/bin/env bash\nset -euo pipefail\n\n# Install Rust toolchain (if not installed) and cargo2junit for JUnit XML conversion\n# Do not use sudo. This script will attempt to install rustup if cargo is missing.\n\n# Ensure HOME is set\n: \"${HOME:=$HOME}\"\n\n# Add cargo to PATH if present\nexport PATH=\"$HOME/.cargo/bin:$PATH\"\n\nif ! command -v cargo >/dev/null 2>&1; then\n    echo \"cargo not found, installing rustup (stable toolchain)...\"\n    # Install rustup (non-interactive)\n    if command -v curl >/dev/null 2>&1; then\n        curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y\n    elif command -v wget >/dev/null 2>&1; then\n        wget -qO- https://sh.rustup.rs | sh -s -- -y\n    else\n        echo \"Error: neither curl nor wget is available to install rustup\" >&2\n        exit 1\n    fi\n    export PATH=\"$HOME/.cargo/bin:$PATH\"\nfi\n\n# Ensure cargo is now available\nif ! command -v cargo >/dev/null 2>&1; then\n    echo \"Error: cargo is not available after rustup installation\" >&2\n    exit 1\nfi\n\n# Install cargo2junit for converting cargo JSON output into JUnit XML\nif ! command -v cargo2junit >/dev/null 2>&1; then\n    echo \"Installing cargo2junit...\"\n    cargo install cargo2junit || {\n        echo \"cargo install cargo2junit failed, trying to install from crates.io may be unavailable\" >&2\n        exit 1\n    }\nfi\n\necho \"Setup complete.\"\ncargo fetch --locked\n","test_command":"","additions":3,"deletions":0,"file_changes":1,"image":"acvdpwu2p001dcr.azurecr.io/uutils__coreutils-6268:20251201"}
{"repo":"RustPython/RustPython","pull_number":1496,"instance_id":"RustPython__RustPython-1496","issue_numbers":[1404],"base_commit_sha":"cc76649567cf42188cbcdf8eac8ca401120e0d22","patch":"diff --git a/vm/src/obj/objtype.rs b/vm/src/obj/objtype.rs\nindex eaf6d187f..a3f781284 100644\n--- a/vm/src/obj/objtype.rs\n+++ b/vm/src/obj/objtype.rs\n@@ -199,6 +199,23 @@ impl PyClassRef {\n         Ok(())\n     }\n \n+    fn del_attr(self, attr_name: PyStringRef, vm: &VirtualMachine) -> PyResult<()> {\n+        if let Some(attr) = class_get_attr(&self.class(), attr_name.as_str()) {\n+            if let Some(ref descriptor) = class_get_attr(&attr.class(), \"__delete__\") {\n+                return vm\n+                    .invoke(descriptor, vec![attr, self.into_object()])\n+                    .map(|_| ());\n+            }\n+        }\n+\n+        if class_get_attr(&self, attr_name.as_str()).is_some() {\n+            self.attributes.borrow_mut().remove(attr_name.as_str());\n+            Ok(())\n+        } else {\n+            Err(vm.new_attribute_error(attr_name.as_str().to_string()))\n+        }\n+    }\n+\n     // This is used for class initialisation where the vm is not yet available.\n     pub fn set_str_attr<V: Into<PyObjectRef>>(&self, attr_name: &str, value: V) {\n         self.attributes\n@@ -255,8 +272,8 @@ pub fn init(ctx: &PyContext) {\n         \"__prepare__\" => ctx.new_rustfunc(PyClassRef::prepare),\n         \"__getattribute__\" => ctx.new_rustfunc(PyClassRef::getattribute),\n         \"__setattr__\" => ctx.new_rustfunc(PyClassRef::set_attr),\n+        \"__delattr__\" => ctx.new_rustfunc(PyClassRef::del_attr),\n         \"__subclasses__\" => ctx.new_rustfunc(PyClassRef::subclasses),\n-        \"__getattribute__\" => ctx.new_rustfunc(PyClassRef::getattribute),\n         \"__instancecheck__\" => ctx.new_rustfunc(PyClassRef::instance_check),\n         \"__subclasscheck__\" => ctx.new_rustfunc(PyClassRef::subclass_check),\n         \"__doc__\" => ctx.new_str(type_doc.to_string()),\n","test_patch":"","problem_statement":"An error occurs when deleting an attribute of a class.\n## Feature\r\n\r\n### Expected Result\r\n```\r\n>>> class C:\r\n...   x = 10\r\n... \r\n>>> del C.x\r\n>>> C.x\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\nAttributeError: type object 'C' has no attribute 'x'\r\n```\r\n\r\n### Actual Result\r\n```\r\n>>>>> class C:\r\n.....   x = 10\r\n..... \r\n>>>>> del C.x\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\nAttributeError: 'type' object has no attribute 'x'\r\n>>>>> C.x\r\n10\r\n```\r\nCan't delete attribute of class.","pull_message":"Implement delattr for type object\nImplement delattr for type object\r\n\r\n### Before\r\n```\r\n>>>>> class C:\r\n.....   x = 10\r\n..... \r\n>>>>> del C.x\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\nAttributeError: 'type' object has no attribute 'x'\r\n>>>>> C.x\r\n10\r\n```\r\n\r\n### After\r\n```\r\n>>>>> class C:\r\n.....   x = 10\r\n.....\r\n>>>>> del C.x\r\n>>>>> C.x\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\nAttributeError: C has no attribute 'x'\r\n```\r\n\r\nFixed: #1404","hints":[],"created_at":"2019-10-09T10:08:48Z","cursor":"Y3Vyc29yOnYyOpK5MjAxOS0xMC0wOVQxODowODo0OCswODowMM4TcQA8","merge_commit_sha":"e5c92d6fa2083471678181a5501660d9a7db8caf","test_files":[],"precommit_script":"","setup_command":"#!/usr/bin/env bash\nset -euo pipefail\n\n# Install Python test dependencies without using sudo or virtualenv\npython3 -m pip install --upgrade pip setuptools wheel\n\n# Install pytest and packages required by the repository test suites\n# Some tests have requirements files; install them if present\nif [ -f extra_tests/requirements.txt ]; then\n    python3 -m pip install -r extra_tests/requirements.txt\nfi\nif [ -f wasm/tests/requirements.txt ]; then\n    python3 -m pip install -r wasm/tests/requirements.txt\nfi\n\n# Also ensure pytest is installed (provides --junitxml)\npython3 -m pip install pytest\n\n# Ensure junit xml support (pytest has it builtin) and any useful plugins\npython3 -m pip install junit-xml || true\n\n# Print installed packages for debugging\npython3 -m pip freeze\n\ncargo fetch --locked\n","test_command":"","additions":18,"deletions":1,"file_changes":1,"image":"acvdpwu2p001dcr.azurecr.io/rustpython__rustpython-1496:20251201"}
{"repo":"starship/starship","pull_number":4760,"instance_id":"starship__starship-4760","issue_numbers":[4759],"base_commit_sha":"d4e664eda5ed06dfa91ae4e97d420afda38c30d9","patch":"diff --git a/src/modules/package.rs b/src/modules/package.rs\nindex 7a2e88a9..d741ad1f 100644\n--- a/src/modules/package.rs\n+++ b/src/modules/package.rs\n@@ -105,7 +105,7 @@ fn get_gradle_version(context: &Context, config: &PackageConfig) -> Option<Strin\n     context\n         .read_file_from_pwd(\"gradle.properties\")\n         .and_then(|contents| {\n-            let re = Regex::new(r\"version=(?P<version>.*)\").unwrap();\n+            let re = Regex::new(r\"(?m)^\\s*version\\s*=\\s*(?P<version>.*)\").unwrap();\n             let caps = re.captures(&contents)?;\n             format_version(&caps[\"version\"], config.version_format)\n         }).or_else(|| {\n@@ -979,6 +979,18 @@ java {\n         expect_output(&project_dir, Some(\"v1.2.3\"), None);\n         project_dir.close()\n     }\n+    #[test]\n+    fn test_extract_grade_version_from_properties_with_comment_and_whitespace() -> io::Result<()> {\n+        let config_name = \"gradle.properties\";\n+        let config_content = \"\n+            # or use -Pversion=0.0.1\n+            version = 1.2.3\n+            \";\n+        let project_dir = create_project_dir()?;\n+        fill_config(&project_dir, config_name, Some(config_content))?;\n+        expect_output(&project_dir, Some(\"v1.2.3\"), None);\n+        project_dir.close()\n+    }\n \n     #[test]\n     fn test_extract_mix_version() -> io::Result<()> {\n","test_patch":"","problem_statement":"Getting a package version from gradle.properties is not implemented correctly\n#### Current Behavior\r\nCommented out lines in gradle.properties with 'version=' will be matched as defining a version. versions defined with whitespace between 'version' and '=' will not be extract properly.\r\n\r\n#### Expected Behavior\r\nComment lines should be ignored. Whitespace should be allowed on either side of '='.\r\n\r\n#### Additional context/Screenshots\r\nE.g. this content in a gradle.properties file should NOT set the version to 0.0.1\r\n```\r\n# Generally it is better to set the version only for release builds, build time\r\n# from command line using -Pversion=0.0.1\r\n```\r\n\r\n#### Possible Solution\r\nFix the regex on this line https://github.com/starship/starship/blob/master/src/modules/package.rs#L108\r\n\r\n#### Environment\r\n- Starship version: 1.12.0\r\n- zsh version: zsh 5.8.1 (x86_64-apple-darwin22.0)\r\n- Operating system: Mac OS 13.2.0\r\n- Terminal emulator: WarpTerminal v0.2022.12.13.08.04.stable_01\r\n- Git Commit Hash: \r\n- Branch/Tag: master\r\n- Rust Version: rustc 1.65.0 (897e37553 2022-11-02)\r\n- Rust channel: stable-x86_64-apple-darwin release\r\n- Build Time: 2022-12-13 16:12:55 +00:00\r\n","pull_message":"fix(package): Improve regex for extracting gradle version from gradle.properties\n\r\n#### Description\r\nChanged regex to ```(?m)^\\s*version\\s*=\\s*(?P<version>.*)``` to account for comment lines and possible whitespace.\r\n\r\n#### Motivation and Context\r\nCloses #4759\r\n\r\n#### How Has This Been Tested?\r\nAdded test with build.gradle file that contains commented out ```version=``` that was picked up by previous regex and with whitespace around the '='\r\n\r\n- [x ] I have tested using **MacOS**\r\n- [ ] I have tested using **Linux**\r\n- [ ] I have tested using **Windows**\r\n\r\n#### Checklist:\r\n<!--- Go over all the following points, and put an `x` in all the boxes that apply. -->\r\n<!--- If you're unsure about any of these, don't hesitate to ask. We're here to help! -->\r\n- [ ] I have updated the documentation accordingly.\r\n- [x] I have updated the tests accordingly.\r\n","hints":[],"created_at":"2022-12-26T03:25:19Z","cursor":"Y3Vyc29yOnYyOpK5MjAyMi0xMi0yNlQxMToyNToxOSswODowMM5GLlUU","merge_commit_sha":"9093891acbe2c86b1615c37386dadbb0cc632199","test_files":[],"precommit_script":"","setup_command":"#!/usr/bin/env bash\nset -euo pipefail\n\n# Minimal environment setup for running tests in this Rust repository\n# Do not use sudo in this script (per instructions)\n\necho \"Setting up environment for tests...\"\n\n# Update package lists if apt is available\nif command -v apt-get >/dev/null 2>&1; then\n  echo \"Detected apt-get, installing required packages: git, python3, python3-pip\"\n  # apt-get can be run without sudo in many CI environments where container runs as root\n  apt-get update -y\n  apt-get install -y git python3 python3-pip\nfi\n\n# Ensure Python tooling is available for converting test output to JUnit XML\nif command -v pip3 >/dev/null 2>&1; then\n  pip3 install --upgrade pip\n  pip3 install junit-xml\nfi\n\n# Install cargo helper tools if cargo is available\nif command -v cargo >/dev/null 2>&1; then\n  echo \"Cargo detected: installing cargo2junit as helper (best-effort)\"\n  # cargo install will place binaries in $HOME/.cargo/bin\n  # This is best-effort; if it fails, run_tests.sh falls back to a python converter\n  cargo install cargo2junit || true\nfi\n\necho \"Setup complete.\" \n\ncargo fetch --locked\n","test_command":"","additions":13,"deletions":1,"file_changes":1,"image":"acvdpwu2p001dcr.azurecr.io/starship__starship-4760:20251201"}
{"repo":"hatoo/oha","pull_number":229,"instance_id":"hatoo__oha-229","issue_numbers":[189],"base_commit_sha":"7a24dac7fb6f8e65b71ef9e11e3fc1606946175d","patch":"diff --git a/src/printer.rs b/src/printer.rs\nindex 514bf5a..d858b5b 100644\n--- a/src/printer.rs\n+++ b/src/printer.rs\n@@ -279,8 +279,8 @@ fn print_summary<W: Write, E: std::fmt::Display>(\n     writeln!(w, \"Summary:\")?;\n     writeln!(\n         w,\n-        \"  Success rate:\\t{:.4}\",\n-        res.iter().filter(|r| r.is_ok()).count() as f64 / res.len() as f64\n+        \"  Success rate:\\t{:.2}%\",\n+        100.0 * res.iter().filter(|r| r.is_ok()).count() as f64 / res.len() as f64\n     )?;\n     writeln!(w, \"  Total:\\t{:.4} secs\", total_duration.as_secs_f64())?;\n     writeln!(\n@@ -360,7 +360,7 @@ fn print_summary<W: Write, E: std::fmt::Display>(\n     writeln!(w, \"Response time histogram:\")?;\n     print_histogram(w, &durations)?;\n     writeln!(w)?;\n-    writeln!(w, \"Latency distribution:\")?;\n+    writeln!(w, \"Response time distribution:\")?;\n     print_distribution(w, &durations)?;\n     writeln!(w)?;\n \n","test_patch":"","problem_statement":"Are there some differences between 'Response time' and 'Latency' in the report?\n![report](https://user-images.githubusercontent.com/25378640/190362929-8337e83b-4cca-44c8-a419-1f474ef37d1d.png)\r\n","pull_message":"Update printer\nResolve #189 #228 \r\n\r\nSince we have JSON output, we assume users don't parse from the summary output and we don't aim for a 100% compatible summary of `hey`.","hints":[],"created_at":"2023-06-10T06:31:23Z","cursor":"Y3Vyc29yOnYyOpK5MjAyMy0wNi0xMFQxNDozMToyMyswODowMM5SrHIg","merge_commit_sha":"d33e84b25f0f3fe7026030d461ba117dd456f107","test_files":[],"precommit_script":"","setup_command":"#!/usr/bin/env bash\nset -euo pipefail\n\n# Install tools required to run tests and produce JUnit XML reports.\n# Do not use sudo. We assume rust and cargo are already installed in the environment.\n# Ensure ~/.cargo/bin is on PATH\nexport PATH=\"$HOME/.cargo/bin:$PATH\"\n\n# Install cargo2junit for converting cargo test JSON output into JUnit XML.\n# If it's already installed, cargo will skip rebuilding it.\nif ! command -v cargo2junit >/dev/null 2>&1; then\n    echo \"Installing cargo2junit...\"\n    cargo install cargo2junit\nelse\n    echo \"cargo2junit already installed\"\nfi\n\n# Print versions for debugging\nrustc --version || true\ncargo --version || true\nif command -v cargo2junit >/dev/null 2>&1; then\n    echo \"cargo2junit is installed\"\nelse\n    echo \"cargo2junit is not installed\"\nfi\n\necho \"Setup complete.\"\ncargo fetch --locked\n","test_command":"","additions":3,"deletions":3,"file_changes":1,"image":"acvdpwu2p001dcr.azurecr.io/hatoo__oha-229:20251201"}
{"repo":"ogham/exa","pull_number":552,"instance_id":"ogham__exa-552","issue_numbers":[548],"base_commit_sha":"69827e05f39489e091dc7b1c2dae85dfcb3d865a","patch":"diff --git a/src/output/grid.rs b/src/output/grid.rs\nindex bac692c..f271f56 100644\n--- a/src/output/grid.rs\n+++ b/src/output/grid.rs\n@@ -63,6 +63,9 @@ impl<'a> Render<'a> {\n             // This isnt *quite* the same as the lines view, which also\n             // displays full link paths.\n             for file in &self.files {\n+                if self.opts.icons {\n+                    write!(w, \"{}\", painted_icon(&file, &self.style))?;\n+                }\n                 let name_cell = self.style.for_file(file, self.colours).paint();\n                 writeln!(w, \"{}\", name_cell.strings())?;\n             }\n","test_patch":"","problem_statement":"Icons fail to display if the files are displayed in 1 column\nIcons fail to display if:\r\n\r\n* `-l` (`--long`) is **not** specified,\r\n* there are two or more files, and\r\n* the file names are long enough that only one column will fit.\r\n\r\nSteps to reproduce:\r\n\r\n```console\r\n$ > aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.txt\r\n$ > bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb.txt\r\n$ exa --icons\r\naaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.txt\r\nbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb.txt\r\n```\r\n\r\nThe file names may need to be longer if your terminal is wide enough.\r\n\r\nexa version: built from master branch (commit 89c861f)","pull_message":"Display icons when file names are too long for grid\nFixes #548","hints":[],"created_at":"2019-07-31T01:35:40Z","cursor":"Y3Vyc29yOnYyOpK5MjAxOS0wNy0zMVQwOTozNTo0MCswODowMM4SC6hs","merge_commit_sha":"404ed20fd35900330e4101a79c4683ba7be26107","test_files":[],"precommit_script":"","setup_command":"#!/usr/bin/env bash\nset -euo pipefail\n\n# Minimal setup script to install Rust toolchain and cargo2junit for producing JUnit XML\n# This script does not use sudo. It installs rustup (if not present) and then installs cargo2junit.\n\n# If rustc already exists and is reasonably recent, skip rustup installation\nif command -v rustc >/dev/null 2>&1; then\n  echo \"rustc found: $(rustc --version)\"\nelse\n  echo \"Installing rustup and Rust toolchain...\"\n  # Install rustup non-interactively\n  curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y\n  # shellcheck disable=SC1090\n  source \"$HOME/.cargo/env\"\nfi\n\n# Ensure cargo is available in PATH\nif ! command -v cargo >/dev/null 2>&1; then\n  echo \"cargo not found even after rustup; aborting\"\n  exit 1\nfi\n\n# Try to ensure the toolchain matches project requirement if specified\n# The project requests rust 1.66.1; attempt to install that toolchain if possible\nif rustup toolchain list >/dev/null 2>&1; then\n  if ! rustup toolchain list | grep -q \"1.66.1\"; then\n    echo \"Installing rust toolchain 1.66.1 (may take a while)...\"\n    rustup toolchain install 1.66.1 || true\n  fi\n  # Use the toolchain if installed\n  if rustup toolchain list | grep -q \"1.66.1\"; then\n    rustup default 1.66.1 || true\n  fi\nfi\n\n# Ensure cargo is usable\necho \"Using cargo: $(cargo --version)\"\n\n# Install cargo2junit to convert cargo JSON output to JUnit XML\n# If already installed, skip\nif command -v cargo2junit >/dev/null 2>&1; then\n  echo \"cargo2junit already installed: $(cargo2junit --version 2>/dev/null || true)\"\nelse\n  echo \"Installing cargo2junit (may take a while)...\"\n  # Try installing using the project's default toolchain first\n  if ! cargo install cargo2junit --version \"0.1.13\"; then\n    # If that fails due to an old rust toolchain, try installing with the latest stable toolchain\n    echo \"Falling back to installing cargo2junit using the 'stable' toolchain\"\n    rustup toolchain install stable || true\n    rustup run stable cargo install cargo2junit || true\n  fi\nfi\n\necho \"Setup complete\"\n\ncargo fetch --locked\n","test_command":"","additions":3,"deletions":0,"file_changes":1,"image":"acvdpwu2p001dcr.azurecr.io/ogham__exa-552:20251201"}
{"repo":"mfontanini/presenterm","pull_number":34,"instance_id":"mfontanini__presenterm-34","issue_numbers":[32],"base_commit_sha":"8215449d5c1d9f741f16971797e5c2c6ee904583","patch":"diff --git a/src/builder.rs b/src/builder.rs\nindex 4d73f2e..c9787be 100644\n--- a/src/builder.rs\n+++ b/src/builder.rs\n@@ -281,13 +281,7 @@ impl<'a> PresentationBuilder<'a> {\n     }\n \n     fn process_pause(&mut self) {\n-        // Remove the last line, if any, if the previous element is a list. This allows each\n-        // element in a list showing up without newlines in between..\n-        if matches!(self.slide_state.last_element, LastElement::List { .. })\n-            && matches!(self.chunk_operations.last(), Some(RenderOperation::RenderLineBreak))\n-        {\n-            self.chunk_operations.pop();\n-        }\n+        self.slide_state.last_chunk_ended_in_list = matches!(self.slide_state.last_element, LastElement::List { .. });\n \n         let chunk_operations = mem::take(&mut self.chunk_operations);\n         self.slide_chunks.push(SlideChunk::new(chunk_operations));\n@@ -357,10 +351,19 @@ impl<'a> PresentationBuilder<'a> {\n     fn push_image(&mut self, path: PathBuf) -> Result<(), BuildError> {\n         let image = self.resources.image(&path)?;\n         self.chunk_operations.push(RenderOperation::RenderImage(image));\n+        self.chunk_operations.push(RenderOperation::SetColors(self.theme.default_style.colors.clone()));\n         Ok(())\n     }\n \n     fn push_list(&mut self, list: Vec<ListItem>) {\n+        let last_chunk_operation = self.slide_chunks.last().and_then(|chunk| chunk.iter_operations().last());\n+        // If the last chunk ended in a list, pop the newline so we get them all next to each\n+        // other.\n+        if matches!(last_chunk_operation, Some(RenderOperation::RenderLineBreak))\n+            && self.slide_state.last_chunk_ended_in_list\n+        {\n+            self.slide_chunks.last_mut().unwrap().pop_last();\n+        }\n         // If this chunk just starts (because there was a pause), pick up from the last index.\n         let start_index = match self.slide_state.last_element {\n             LastElement::List { last_index } if self.chunk_operations.is_empty() => last_index + 1,\n@@ -587,6 +590,7 @@ impl<'a> PresentationBuilder<'a> {\n struct SlideState {\n     ignore_element_line_break: bool,\n     needs_enter_column: bool,\n+    last_chunk_ended_in_list: bool,\n     last_element: LastElement,\n     layout: LayoutState,\n }\ndiff --git a/src/presentation.rs b/src/presentation.rs\nindex 1b4ae34..1c789c9 100644\n--- a/src/presentation.rs\n+++ b/src/presentation.rs\n@@ -223,6 +223,10 @@ impl SlideChunk {\n     pub(crate) fn iter_operations(&self) -> impl Iterator<Item = &RenderOperation> + Clone {\n         self.0.iter()\n     }\n+\n+    pub(crate) fn pop_last(&mut self) -> Option<RenderOperation> {\n+        self.0.pop()\n+    }\n }\n \n /// The metadata for a presentation.\n","test_patch":"","problem_statement":"List | pause | paragraph combo removes needed line break\nThe following presentation gets the necessary line break that should normally be in between the list and the paragraph removed and looks off.\r\n\r\n```markdown\r\n* Hi\r\n<!-- pause -->\r\nmom\r\n```","pull_message":"Don't remove newlines after every list + pause\nThis makes it so that a list + pause combo doesn't always pop the newline as this only should be the behavior if the thing right after is a list.\r\n\r\nFixes #32.","hints":[],"created_at":"2023-11-02T00:01:21Z","cursor":"Y3Vyc29yOnYyOpK5MjAyMy0xMS0wMlQwODowMToyMSswODowMM5eYdzD","merge_commit_sha":"b252b2ad9d7e32991d0575f0140294fdedb0847a","test_files":[],"precommit_script":"","setup_command":"#!/usr/bin/env bash\nset -euo pipefail\n\n# Setup script for the presenterm repository.\n# Installs tools required to run tests and generate a JUnit XML report.\n\n# Ensure cargo is available (rust toolchain). If not, try to install via rustup.\nif ! command -v cargo >/dev/null 2>&1; then\n    echo \"cargo not found. Installing rustup...\"\n    # Non-interactive rustup installation\n    curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y\n    # shellcheck source=/dev/null\n    source \"$HOME/.cargo/env\"\nfi\n\n# Ensure cargo bin dir is in PATH\nexport PATH=\"$HOME/.cargo/bin:$PATH\"\n\n# Install cargo2junit to convert cargo test output to JUnit XML\nif ! command -v cargo2junit >/dev/null 2>&1; then\n    echo \"Installing cargo2junit...\"\n    cargo install cargo2junit\nfi\n\necho \"Setup complete. cargo: $(cargo --version)\" \n\ncargo fetch --locked\n","test_command":"","additions":15,"deletions":7,"file_changes":2,"image":"acvdpwu2p001dcr.azurecr.io/mfontanini__presenterm-34:20251201"}
{"repo":"RustPython/RustPython","pull_number":3472,"instance_id":"RustPython__RustPython-3472","issue_numbers":[3468],"base_commit_sha":"9fb70707c4803f9f6d79dd4c8077bd16f0a9be45","patch":"diff --git a/vm/src/builtins/slice.rs b/vm/src/builtins/slice.rs\nindex 68e5d6886..add827d7d 100644\n--- a/vm/src/builtins/slice.rs\n+++ b/vm/src/builtins/slice.rs\n@@ -368,13 +368,15 @@ impl SaturatedSliceIter {\n \n impl Iterator for SaturatedSliceIter {\n     type Item = usize;\n+\n     fn next(&mut self) -> Option<Self::Item> {\n         if self.len == 0 {\n             return None;\n         }\n         self.len -= 1;\n         let ret = self.index as usize;\n-        self.index += self.step;\n+        // SAFETY: if index is overflowed, len should be zero\n+        self.index = self.index.wrapping_add(self.step);\n         Some(ret)\n     }\n }\n","test_patch":"","problem_statement":"SaturatedSliceIter::next has overflow bug\n```sh\r\n$ cargo run Lib/test/test_list.py -v -k test_extendedslicing\r\n\r\ntest_extendedslicing (__main__.ListTest) ... thread 'main' panicked at 'attempt to add with overflow', vm/src/builtins/slice.rs:377:9\r\n```\r\n\r\nProbably introduced in #3340 ","pull_message":"fix #3468 SaturatedSliceIter overflow\nfixes #3468 ","hints":[],"created_at":"2021-11-28T09:18:32Z","cursor":"Y3Vyc29yOnYyOpK5MjAyMS0xMS0yOFQxNzoxODozMiswODowMM4vF2Dz","merge_commit_sha":"e740de697b1dfe6ae2e3841a0d7ae55e1e6bec12","test_files":[],"precommit_script":"","setup_command":"#!/usr/bin/env bash\nset -euo pipefail\n\n# Install Python test dependencies without using sudo or virtualenv\npython3 -m pip install --upgrade pip setuptools wheel\n\n# Install pytest and packages required by the repository test suites\n# Some tests have requirements files; install them if present\nif [ -f extra_tests/requirements.txt ]; then\n    python3 -m pip install -r extra_tests/requirements.txt\nfi\nif [ -f wasm/tests/requirements.txt ]; then\n    python3 -m pip install -r wasm/tests/requirements.txt\nfi\n\n# Also ensure pytest is installed (provides --junitxml)\npython3 -m pip install pytest\n\n# Ensure junit xml support (pytest has it builtin) and any useful plugins\npython3 -m pip install junit-xml || true\n\n# Print installed packages for debugging\npython3 -m pip freeze\n\ncargo fetch --locked\n","test_command":"","additions":3,"deletions":1,"file_changes":1,"image":"acvdpwu2p001dcr.azurecr.io/rustpython__rustpython-3472:20251201"}
